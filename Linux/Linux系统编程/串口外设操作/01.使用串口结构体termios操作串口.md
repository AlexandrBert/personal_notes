# linux 串口编程（termios 结构体）

termios （全称：Term I/O Setting） 结构体是在POSIX规范中定义的标准接口，它类似于 system V 中的 termio 接口。

在Linux和Unix系统中用于配置终端设备的输入和输出属性。它提供了一种标准化的方法来控制终端的行为，包括行缓冲、信号处理、输入和输出处理等。

## 1. termios 结构体定义
结构体包括输入模式标志位、输出模式标志位、控制模式标志位、本地模式标志位、行规程、控制字符、输入速度和输出速度等。

termios 结构体定义在 `xx-gnu/bits/termios.h` 头文件中，但是用户一般不需要直接访问这个头文件，而是通过 `termios.h` 头文件来使用 termios 结构体。

```c
typedef unsigned char	cc_t;
typedef unsigned int	speed_t;
typedef unsigned int	tcflag_t;

#define NCCS 32
struct termios
  {
    tcflag_t c_iflag;		/* input mode flags */
    tcflag_t c_oflag;		/* output mode flags */
    tcflag_t c_cflag;		/* control mode flags */
    tcflag_t c_lflag;		/* local mode flags */
    cc_t c_line;			/* line discipline */
    cc_t c_cc[NCCS];		/* control characters */
    speed_t c_ispeed;		/* input speed */
    speed_t c_ospeed;		/* output speed */
#define _HAVE_STRUCT_TERMIOS_C_ISPEED 1
#define _HAVE_STRUCT_TERMIOS_C_OSPEED 1
  };
```

## 2. 相关操作函数
操作函数主要包括在 `termios.h` 头文件中，调用该头文件接口函数可以对 termios 结构体进行操作。
### 2.1. 
```c
/* Return the output baud rate stored in *TERMIOS_P.  */
extern speed_t cfgetospeed (const struct termios *__termios_p) __THROW;

/* Return the input baud rate stored in *TERMIOS_P.  */
extern speed_t cfgetispeed (const struct termios *__termios_p) __THROW;

/* Set the output baud rate stored in *TERMIOS_P to SPEED.  */
extern int cfsetospeed (struct termios *__termios_p, speed_t __speed) __THROW;

/* Set the input baud rate stored in *TERMIOS_P to SPEED.  */
extern int cfsetispeed (struct termios *__termios_p, speed_t __speed) __THROW;

#ifdef	__USE_MISC
/* Set both the input and output baud rates in *TERMIOS_OP to SPEED.  */
extern int cfsetspeed (struct termios *__termios_p, speed_t __speed) __THROW;
#endif
```