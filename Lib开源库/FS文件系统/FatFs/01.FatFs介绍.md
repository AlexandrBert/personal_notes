
# FatFs 文件系统简介
FatFs 是一个通用的 FAT/exFAT 文件系统模块，用于小型嵌入式系统。 FatFs 模块是按照ANSI C（C89）编写的，并且与磁盘控制层完全分离。因此，它独立于平台和存储设备。它可以集成到资源有限的小型微控制器中，如 8051，PIC，AVR，ARM，Z80，RX等。这里还提供用于微型微控制器的 [Petit FatFs](./02.Petit%20FatFs文件系统介绍.md) 模块。

**特点：**
- DOS/Windows 兼容 FAT/exFAT 文件系统。
- 平台独立。移植轻松。
- 程序代码和工作区域的占用空间非常小。
- 支持的各种配置选项：
    - ANSI/OEM 或 Unicode 中的长文件名。
    - exFAT 文件存储器，64 位 LBA 和 GPT ，用于大容量存储。
    - RTOS 的线程安全。
    - 多个字母。（物理驱动器和分区）
    - 可变扇区大小。
    - 包括 DBCS 的多个代码页。
    - 只读、可选 API、I/O缓冲区等

以下内容为 FatFs 模块应用说明，主要介绍 FatFs 模块的基本概念，如何移植，以及如何使用 FatFs 模块。

原文为地址为：[FatFs Application Note](http://elm-chan.org/fsw/ff/doc/appnote.html)

具体内容可以参照官网地址：[http://elm-chan.org/fsw/ff/00index_e.html](http://elm-chan.org/fsw/ff/00index_e.html)

## 1. 应用接口函数
FatFs provides various filesystem functions for the applications as shown below.

- **文件访问**
    - `f_open` - Open/Create a file
    - `f_close` - Close an open file
    - `f_read` - Read data from the file
    - `f_write` - Write data to the file
    - `f_lseek` - Move read/write pointer, Expand size
    - `f_truncate` - Truncate file size
    - `f_sync` - Flush cached data
    - `f_forward` - Forward data to the stream
    - `f_expand` - Allocate a contiguous block to the file
    - `f_gets` - Read a string
    - `f_putc` - Write a character
    - `f_puts` - Write a string
    - `f_printf` - Write a formatted string
    - `f_tell` - Get current read/write pointer
    - `f_eof` - Test for end-of-file
    - `f_size` - Get size
    - `f_error` - Test for an error
- **目录访问**
    - `f_opendir` - Open a directory
    - `f_closedir` - Close an open directory
    - `f_readdir` - Read a directory item
    - `f_findfirst` - Open a directory and read the first item matched
    - `f_findnext` - Read a next item matched
- **文件和目录管理**
    - `f_stat` - Check existance of a file or sub-directory
    - `f_unlink` - Remove a file or sub-directory
    - `f_rename` - Rename/Move a file or sub-directory
    - `f_chmod` - Change attribute of a file or sub-directory
    - `f_utime` - Change timestamp of a file or sub-directory
    - `f_mkdir` - Create a sub-directory
    - `f_chdir` - Change current directory
    - `f_chdrive` - Change current drive
    - `f_getcwd` - Retrieve the current directory and drive
- **分区（卷）管理和系统配置**
    - `f_mount` - Register/Unregister the work area of the volume
    - `f_mkfs` - Create an FAT volume on the logical drive
    - `f_fdisk` - Create partitions on the physical drive
    - `f_getfree` - Get free space on the volume
    - `f_getlabel` - Get volume label
    - `f_setlabel` - Set volume label
    - `f_setcp` - Set active code page


## 2. 媒体访问接口
由于FatFs模块是独立于平台和存储介质的文件存储层，因此它与物理设备（如存储卡，硬盘和任何类型的存储设备）完全分离。存储设备控制模块不是 FatFs 模块的一部分，需要由实现者提供。FatFs 通过一个简单的媒体访问接口控制存储设备，如下所示。下载中还提供了一些平台的示例实现。此处提供存储设备控制模块的功能检查器。

- **存储设备控制**
    - `diskstatus` -获取设备状态
    - `diskinitialize` -初始化设备
    - `diskread` -读取数据
    - `diskwrite` -写入数据
    - `diskioctl` -控制设备相关函数
- **实时时钟**
    - `getfattime` -获取当前时间